# Video Converter - Product Requirements Document (PRD)

**문서 버전**: 1.0.0
**작성일**: 2025-12-21
**상태**: Draft
**작성자**: Product Team

---

## 목차

1. [Executive Summary](#1-executive-summary)
2. [문제 정의](#2-문제-정의)
3. [제품 비전 및 목표](#3-제품-비전-및-목표)
4. [사용자 페르소나](#4-사용자-페르소나)
5. [사용자 스토리](#5-사용자-스토리)
6. [기능 요구사항](#6-기능-요구사항)
7. [비기능 요구사항](#7-비기능-요구사항)
8. [사용자 플로우](#8-사용자-플로우)
9. [UI/UX 요구사항](#9-uiux-요구사항)
10. [범위 정의](#10-범위-정의)
11. [의존성 및 제약사항](#11-의존성-및-제약사항)
12. [성공 지표](#12-성공-지표)
13. [릴리스 계획](#13-릴리스-계획)
14. [부록](#14-부록)

---

## 1. Executive Summary

### 1.1 제품 개요

**Video Converter**는 macOS 사용자를 위한 자동화된 비디오 코덱 변환 솔루션입니다. Apple Photos 라이브러리에 저장된 H.264 코덱 동영상을 H.265(HEVC)로 자동 변환하여 **50% 이상의 저장 공간 절약**을 실현하면서도 **시각적으로 동일한 화질**과 **모든 메타데이터(GPS, 날짜, 앨범 정보)**를 완벽하게 보존합니다.

### 1.2 핵심 가치 제안

```
┌─────────────────────────────────────────────────────────────────────┐
│                        핵심 가치 제안                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                       │
│   "소중한 추억은 그대로, 저장 공간만 절반으로"                            │
│                                                                       │
│   ✓ 자동화: 설정 한 번으로 매일 자동 실행                               │
│   ✓ 무손실: 눈으로 구분할 수 없는 화질 유지                              │
│   ✓ 안전함: GPS, 날짜 등 모든 메타데이터 100% 보존                       │
│   ✓ 효율성: Apple Silicon 하드웨어 가속으로 빠른 변환                    │
│                                                                       │
└─────────────────────────────────────────────────────────────────────┘
```

### 1.3 목표 시장

- **Primary**: macOS 환경에서 Apple Photos를 사용하는 개인 사용자
- **Secondary**: 대량의 비디오 아카이브를 관리하는 프로슈머/크리에이터

---

## 2. 문제 정의

### 2.1 사용자 Pain Points

#### Pain Point 1: 급격히 증가하는 비디오 저장 공간

> "아이폰으로 찍은 4K 영상들이 쌓이면서 512GB iCloud도 부족해졌어요. 매달 iCloud 요금만 내는 것도 부담이에요."

**현황**:
- 스마트폰 카메라 성능 향상 → 4K 60fps 촬영 보편화
- 1분 4K 영상 = 약 400MB (H.264 기준)
- 평균 사용자: 월 50-100개 영상 촬영 → 월 20-40GB 증가

**결과**:
- iCloud/로컬 저장 공간 부족
- 추가 저장 공간 구매 비용 발생
- 소중한 영상 삭제 압박

#### Pain Point 2: 수동 변환의 번거로움

> "HandBrake로 하나씩 변환하려니 너무 시간이 많이 걸리고, 설정도 어렵습니다."

**현황**:
- 기존 변환 도구: 파일별 수동 작업 필요
- 복잡한 인코딩 설정 이해 필요
- 메타데이터 손실 위험

**결과**:
- 변환 작업 포기
- 비효율적인 저장 공간 사용 지속

#### Pain Point 3: 메타데이터 손실 우려

> "변환하면 GPS 정보랑 촬영 날짜가 사라질까 봐 걱정돼요. 여행 추억인데..."

**현황**:
- 대부분의 변환 도구: 메타데이터 부분 손실
- GPS 좌표: 특히 손실 위험 높음
- Photos 앱 정렬/검색 기능 무력화

**결과**:
- 변환 후 사진 앱에서 위치 기반 검색 불가
- 시간순 정렬 깨짐
- 추억의 맥락 상실

### 2.2 기회 분석

| 요인 | 현황 | 기회 |
|------|------|------|
| H.265 코덱 성숙도 | 모든 Apple 기기 지원 (2017+) | 호환성 문제 없이 전환 가능 |
| Apple Silicon 보급 | M1+ Mac 대다수 | 하드웨어 가속으로 빠른 변환 |
| 자동화 인프라 | macOS launchd 내장 | 별도 앱 없이 백그라운드 실행 |
| 오픈소스 도구 | FFmpeg, osxphotos 성숙 | 안정적인 기술 기반 확보 |

---

## 3. 제품 비전 및 목표

### 3.1 제품 비전

> **"모든 macOS 사용자가 저장 공간 걱정 없이 추억을 보관할 수 있도록"**

### 3.2 제품 목표

#### 단기 목표 (v1.0)

| # | 목표 | 측정 지표 |
|---|------|----------|
| G1 | 자동화된 배치 변환 제공 | 설정 후 사용자 개입 0회 |
| G2 | 50% 이상 저장 공간 절약 | 평균 압축률 50%+ |
| G3 | 메타데이터 100% 보존 | GPS, 날짜 보존율 100% |
| G4 | 시각적 무손실 품질 | VMAF 93+ |

#### 중기 목표 (v1.x)

| # | 목표 | 측정 지표 |
|---|------|----------|
| G5 | 직관적인 GUI 제공 | NPS 50+ |
| G6 | iCloud 통합 지원 | 클라우드 영상 변환 가능 |
| G7 | 스마트 일정 관리 | 시스템 리소스 기반 자동 스케줄링 |

#### 장기 목표 (v2.0+)

| # | 목표 | 측정 지표 |
|---|------|----------|
| G8 | Photos 앱 내 교체 | 원본 대체 기능 |
| G9 | AV1 코덱 지원 | M3+ 하드웨어 가속 활용 |
| G10 | 크로스 플랫폼 | iOS/iPadOS 지원 |

---

## 4. 사용자 페르소나

### 4.1 Primary Persona: "가족 기록자" 민수

```
┌─────────────────────────────────────────────────────────────────────┐
│  👤 민수 (38세, 직장인)                                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                       │
│  📱 기기: iPhone 15 Pro, MacBook Air M2, 200GB iCloud                │
│  📸 활동: 주말마다 가족 영상 촬영, 월 30-50개 4K 영상                    │
│  💾 현황: iCloud 90% 사용 중, 매달 저장 공간 부족 경고                   │
│                                                                       │
│  🎯 목표:                                                              │
│  • 가족 영상 모두 보관하고 싶음                                          │
│  • 추가 iCloud 비용 피하고 싶음                                         │
│  • 복잡한 설정 없이 자동으로 처리되길 원함                                │
│                                                                       │
│  😤 불만:                                                              │
│  • "영상 지우라는 알림이 자꾸 와요"                                       │
│  • "HandBrake 설정이 너무 복잡해요"                                     │
│  • "변환하면 촬영 장소 정보가 사라져요"                                   │
│                                                                       │
│  ✅ 성공 기준:                                                          │
│  • 한 번 설정으로 매일 자동 실행                                         │
│  • iCloud 사용량 50% 이하로 유지                                        │
│  • 여행 영상의 지도 보기 기능 유지                                        │
│                                                                       │
└─────────────────────────────────────────────────────────────────────┘
```

### 4.2 Secondary Persona: "영상 아카이버" 지연

```
┌─────────────────────────────────────────────────────────────────────┐
│  👤 지연 (29세, 유튜브 크리에이터)                                       │
├─────────────────────────────────────────────────────────────────────┤
│                                                                       │
│  📱 기기: iPhone 15 Pro Max, Mac Studio M2 Ultra, 4TB SSD             │
│  📸 활동: 일주일에 3-4개 영상 제작, 원본 보관 필수                        │
│  💾 현황: 월 200-300GB 신규 영상, 연간 2-3TB 증가                       │
│                                                                       │
│  🎯 목표:                                                              │
│  • 원본 품질 최대한 유지하면서 저장 공간 절약                             │
│  • 대량 영상 일괄 처리                                                  │
│  • 하드웨어 가속으로 빠른 변환                                           │
│                                                                       │
│  😤 불만:                                                              │
│  • "소프트웨어 인코딩은 너무 느려요"                                      │
│  • "배치 작업 관리가 어려워요"                                           │
│  • "품질 손실이 걱정돼요"                                                │
│                                                                       │
│  ✅ 성공 기준:                                                          │
│  • 4K 1시간 영상 10분 내 변환                                           │
│  • VMAF 95+ 품질 보장                                                  │
│  • 야간 자동 배치 처리                                                   │
│                                                                       │
└─────────────────────────────────────────────────────────────────────┘
```

### 4.3 Tertiary Persona: "기술 애호가" 성호

```
┌─────────────────────────────────────────────────────────────────────┐
│  👤 성호 (45세, 개발자)                                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                       │
│  📱 기기: 다양한 Mac 보유, NAS 운영                                     │
│  📸 활동: 기술 테스트, 스크립트 자동화 선호                               │
│  💾 현황: 커맨드라인 도구 선호, 세밀한 제어 원함                          │
│                                                                       │
│  🎯 목표:                                                              │
│  • CLI로 완벽한 제어                                                    │
│  • 다른 스크립트와 연동                                                  │
│  • 오픈소스로 커스터마이징                                               │
│                                                                       │
│  ✅ 성공 기준:                                                          │
│  • 풍부한 CLI 옵션                                                      │
│  • JSON/YAML 설정 파일 지원                                            │
│  • 파이프라인 통합 가능                                                  │
│                                                                       │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 5. 사용자 스토리

### 5.1 Epic 1: 초기 설정

| ID | 사용자 스토리 | 우선순위 | 수용 기준 |
|----|-------------|---------|----------|
| US-101 | 사용자로서, 설치 스크립트 한 줄로 모든 의존성을 설치하고 싶다 | Must | 5분 내 설치 완료 |
| US-102 | 사용자로서, 설정 마법사로 기본 설정을 완료하고 싶다 | Should | 3단계 이하 설정 |
| US-103 | 사용자로서, Photos 앱 접근 권한을 쉽게 부여하고 싶다 | Must | 시스템 설정 자동 안내 |
| US-104 | 사용자로서, 변환 품질/속도 프리셋을 선택하고 싶다 | Should | 3가지 프리셋 제공 |

### 5.2 Epic 2: 비디오 변환

| ID | 사용자 스토리 | 우선순위 | 수용 기준 |
|----|-------------|---------|----------|
| US-201 | 사용자로서, Photos 라이브러리의 H.264 영상을 자동으로 찾고 싶다 | Must | 수동 선택 불필요 |
| US-202 | 사용자로서, 선택한 영상만 변환하고 싶다 | Should | 앨범/날짜 필터 지원 |
| US-203 | 사용자로서, 변환 진행 상황을 실시간으로 확인하고 싶다 | Should | 진행률 % 표시 |
| US-204 | 사용자로서, 변환 중 Mac을 사용해도 느려지지 않았으면 좋겠다 | Must | CPU 30% 이하 (HW 모드) |
| US-205 | 사용자로서, 이미 변환된 영상은 건너뛰었으면 좋겠다 | Must | 중복 변환 방지 |

### 5.3 Epic 3: 메타데이터 보존

| ID | 사용자 스토리 | 우선순위 | 수용 기준 |
|----|-------------|---------|----------|
| US-301 | 사용자로서, 변환 후에도 촬영 날짜가 유지되길 원한다 | Must | 날짜 100% 보존 |
| US-302 | 사용자로서, 변환 후에도 GPS 위치 정보가 유지되길 원한다 | Must | GPS 100% 보존 |
| US-303 | 사용자로서, 변환 후에도 앨범 정보가 유지되길 원한다 | Should | 앨범 매핑 유지 |
| US-304 | 사용자로서, Finder에서 파일 생성일이 원본과 같길 원한다 | Should | 타임스탬프 동기화 |

### 5.4 Epic 4: 자동화

| ID | 사용자 스토리 | 우선순위 | 수용 기준 |
|----|-------------|---------|----------|
| US-401 | 사용자로서, 매일 특정 시간에 자동 변환이 실행되길 원한다 | Must | 스케줄 설정 가능 |
| US-402 | 사용자로서, 새 영상이 추가되면 자동으로 변환되길 원한다 | Should | 폴더 감시 기능 |
| US-403 | 사용자로서, 변환 완료 시 알림을 받고 싶다 | Should | macOS 알림 지원 |
| US-404 | 사용자로서, Mac을 사용 중일 때는 변환을 미루고 싶다 | Could | 유휴 시간 감지 |

### 5.5 Epic 5: 안전 및 복구

| ID | 사용자 스토리 | 우선순위 | 수용 기준 |
|----|-------------|---------|----------|
| US-501 | 사용자로서, 원본 파일이 즉시 삭제되지 않았으면 좋겠다 | Must | 처리 완료 폴더로 이동 |
| US-502 | 사용자로서, 변환 실패 시 원본이 보존되길 원한다 | Must | 실패 시 원본 유지 |
| US-503 | 사용자로서, 변환된 파일의 품질을 확인하고 싶다 | Should | 검증 보고서 제공 |
| US-504 | 사용자로서, 문제가 생기면 원본으로 복구하고 싶다 | Should | 복구 기능 제공 |

### 5.6 Epic 6: 모니터링 및 보고

| ID | 사용자 스토리 | 우선순위 | 수용 기준 |
|----|-------------|---------|----------|
| US-601 | 사용자로서, 총 절약된 저장 공간을 확인하고 싶다 | Should | 통계 대시보드 |
| US-602 | 사용자로서, 변환 히스토리를 확인하고 싶다 | Should | 로그 조회 기능 |
| US-603 | 사용자로서, 실패한 변환 목록을 확인하고 싶다 | Must | 실패 목록 표시 |
| US-604 | 사용자로서, 다음 예약된 변환 일정을 확인하고 싶다 | Could | 스케줄 표시 |

---

## 6. 기능 요구사항

### 6.1 기능 요구사항 매트릭스

| ID | 기능 | 설명 | 우선순위 | 릴리스 |
|----|------|------|---------|--------|
| **코어 기능** |
| FR-001 | H.264 감지 | 비디오 코덱 자동 감지 | P0 | v1.0 |
| FR-002 | H.265 변환 | VideoToolbox 하드웨어 가속 변환 | P0 | v1.0 |
| FR-003 | 소프트웨어 변환 | libx265 고품질 변환 옵션 | P1 | v1.0 |
| FR-004 | 진행률 표시 | 실시간 변환 진행률 | P1 | v1.0 |
| **Photos 통합** |
| FR-101 | Photos 스캔 | osxphotos로 라이브러리 스캔 | P0 | v1.0 |
| FR-102 | 비디오 필터링 | H.264 영상만 필터링 | P0 | v1.0 |
| FR-103 | 비디오 내보내기 | 원본 비디오 임시 추출 | P0 | v1.0 |
| FR-104 | iCloud 다운로드 | 클라우드 영상 다운로드 | P1 | v1.0 |
| FR-105 | 앨범 필터 | 특정 앨범만 처리 | P2 | v1.1 |
| **메타데이터** |
| FR-201 | 메타데이터 추출 | ExifTool로 전체 메타데이터 추출 | P0 | v1.0 |
| FR-202 | 메타데이터 적용 | 변환 파일에 메타데이터 복원 | P0 | v1.0 |
| FR-203 | GPS 보존 | GPS 좌표 특수 처리 | P0 | v1.0 |
| FR-204 | 타임스탬프 동기화 | 파일 시스템 시간 동기화 | P1 | v1.0 |
| **품질 관리** |
| FR-301 | 무결성 검사 | FFprobe로 파일 검증 | P0 | v1.0 |
| FR-302 | 속성 비교 | 해상도/프레임레이트/길이 비교 | P0 | v1.0 |
| FR-303 | 압축률 검사 | 비정상 압축률 경고 | P1 | v1.0 |
| FR-304 | VMAF 측정 | 품질 점수 계산 (선택적) | P2 | v1.1 |
| **자동화** |
| FR-401 | 스케줄 실행 | launchd StartCalendarInterval | P0 | v1.0 |
| FR-402 | 폴더 감시 | launchd WatchPaths | P1 | v1.0 |
| FR-403 | 알림 발송 | macOS Notification Center | P1 | v1.0 |
| FR-404 | 서비스 관리 | launchctl 래퍼 | P1 | v1.0 |
| **CLI** |
| FR-501 | 단일 변환 | `convert <input> <output>` | P0 | v1.0 |
| FR-502 | 배치 변환 | `run --mode photos` | P0 | v1.0 |
| FR-503 | 상태 조회 | `status` | P1 | v1.0 |
| FR-504 | 통계 조회 | `stats` | P2 | v1.0 |
| FR-505 | 서비스 설치 | `install-service` | P0 | v1.0 |
| **안전** |
| FR-601 | 원본 보존 | 처리 완료 폴더로 이동 | P0 | v1.0 |
| FR-602 | 재시도 로직 | 실패 시 3회 재시도 | P0 | v1.0 |
| FR-603 | 실패 격리 | 실패 파일 별도 폴더 | P0 | v1.0 |
| FR-604 | 체크포인트 | 세션 상태 저장/복구 | P2 | v1.1 |

### 6.2 기능 상세 명세

#### FR-002: H.265 변환 (VideoToolbox)

**설명**: Apple Silicon의 VideoToolbox를 활용한 하드웨어 가속 H.265 인코딩

**입력**:
- H.264 코덱 비디오 파일 (.mp4, .mov, .m4v)
- 품질 설정 (1-100, 기본값 45)

**처리**:
```bash
ffmpeg -i <input> \
  -c:v hevc_videotoolbox \
  -q:v <quality> \
  -tag:v hvc1 \
  -c:a copy \
  -map_metadata 0 \
  -movflags use_metadata_tags \
  <output>
```

**출력**:
- H.265/HEVC 코덱 비디오 파일
- QuickTime 호환 태그 (hvc1)

**성공 기준**:
- 변환 성공률 99%+
- 평균 압축률 50%+
- 변환 속도: 실시간의 20배+ (4K 기준)

#### FR-203: GPS 보존

**설명**: 변환 과정에서 GPS 좌표 정보 완벽 보존

**입력**:
- 원본 비디오의 GPS 메타데이터
  - QuickTime:GPSCoordinates
  - Keys:GPSCoordinates
  - XMP:GPSLatitude/Longitude

**처리**:
1. FFmpeg `-map_metadata 0`으로 기본 복사
2. ExifTool `-tagsFromFile`으로 상세 복사
3. GPS 태그 명시적 복사 (`-GPS*`)
4. 복사 후 검증

**출력**:
- 변환된 비디오에 동일한 GPS 좌표

**성공 기준**:
- GPS 보존율 100%
- 소수점 6자리까지 정확도 유지

---

## 7. 비기능 요구사항

### 7.1 성능 요구사항

| ID | 요구사항 | 목표 | 측정 방법 |
|----|---------|------|----------|
| NFR-P01 | 4K 30분 영상 변환 시간 (HW) | 5분 이내 | 벤치마크 테스트 |
| NFR-P02 | 1080p 10분 영상 변환 시간 (HW) | 30초 이내 | 벤치마크 테스트 |
| NFR-P03 | CPU 사용률 (HW 모드) | 30% 이하 | Activity Monitor |
| NFR-P04 | 메모리 사용량 | 1GB 이하 | Activity Monitor |
| NFR-P05 | 동시 변환 지원 | 2개 | 설정 가능 |

### 7.2 안정성 요구사항

| ID | 요구사항 | 목표 | 측정 방법 |
|----|---------|------|----------|
| NFR-R01 | 변환 성공률 | 99%+ | 배치 테스트 |
| NFR-R02 | 메타데이터 보존율 | 100% | 자동 검증 |
| NFR-R03 | 서비스 가동률 (자동화) | 99.9% | 로그 분석 |
| NFR-R04 | 에러 복구 성공률 | 95%+ | 재시도 로그 |

### 7.3 사용성 요구사항

| ID | 요구사항 | 목표 | 측정 방법 |
|----|---------|------|----------|
| NFR-U01 | 초기 설정 시간 | 5분 이내 | 사용자 테스트 |
| NFR-U02 | CLI 학습 시간 | 10분 이내 | 사용자 테스트 |
| NFR-U03 | 에러 메시지 명확성 | 90% 이해도 | 사용자 피드백 |

### 7.4 호환성 요구사항

| ID | 요구사항 | 목표 | 비고 |
|----|---------|------|------|
| NFR-C01 | macOS 버전 | 12.0+ (Monterey) | Apple Silicon 필수 |
| NFR-C02 | Python 버전 | 3.10+ | osxphotos 요구 |
| NFR-C03 | FFmpeg 버전 | 5.0+ | hevc_videotoolbox 지원 |
| NFR-C04 | 비디오 포맷 | .mp4, .mov, .m4v | H.264 코덱 |

### 7.5 보안 요구사항

| ID | 요구사항 | 목표 | 구현 방법 |
|----|---------|------|----------|
| NFR-S01 | Photos 접근 권한 | 최소 권한 | 읽기 전용 |
| NFR-S02 | 임시 파일 보안 | 사용 후 삭제 | 자동 정리 |
| NFR-S03 | 설정 파일 보안 | 사용자 홈 저장 | 0600 권한 |

---

## 8. 사용자 플로우

### 8.1 초기 설정 플로우

```
┌─────────────────────────────────────────────────────────────────────┐
│                         초기 설정 플로우                               │
└─────────────────────────────────────────────────────────────────────┘

[시작]
   │
   ▼
┌─────────────────┐
│ 1. 설치 스크립트  │ ──▶ brew install, pip install
│    실행          │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 2. 의존성 확인   │ ──▶ ffmpeg, exiftool, osxphotos
│    (자동)        │
└────────┬────────┘
         │
         ▼
┌─────────────────┐     ┌─────────────────┐
│ 3. Photos 권한   │ ──▶ │ 시스템 설정으로  │
│    요청          │     │ 자동 이동        │
└────────┬────────┘     └─────────────────┘
         │
         ▼
┌─────────────────┐
│ 4. 품질 프리셋   │ ──▶ 빠른(HW) / 균형(HW) / 고품질(SW)
│    선택          │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 5. 스케줄 설정   │ ──▶ 매일 새벽 3시 (기본값)
│                 │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 6. 서비스 등록   │ ──▶ launchctl load
│    (자동)        │
└────────┬────────┘
         │
         ▼
[완료 - 자동 실행 대기]
```

### 8.2 자동 변환 플로우

```
┌─────────────────────────────────────────────────────────────────────┐
│                         자동 변환 플로우                               │
└─────────────────────────────────────────────────────────────────────┘

[스케줄 트리거 - 새벽 3시]
   │
   ▼
┌─────────────────┐
│ 1. Photos 스캔   │ ──▶ osxphotos로 비디오 목록 조회
│                 │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 2. H.264 필터   │ ──▶ 이미 HEVC인 영상 제외
│                 │      이미 변환된 영상 제외
└────────┬────────┘
         │
         ▼
┌─────────────────┐     ┌─────────────────┐
│ 3. 대상 없음?   │──Y──▶│ 로그 기록 후    │
│                 │     │ 종료            │
└────────┬────────┘     └─────────────────┘
         │N
         ▼
┌─────────────────┐
│ 4. 비디오별 루프 │
│ ┌─────────────┐ │
│ │ 4a. 내보내기 │ │ ──▶ 임시 디렉토리로 추출
│ └──────┬──────┘ │
│        ▼        │
│ ┌─────────────┐ │
│ │ 4b. 변환    │ │ ──▶ FFmpeg hevc_videotoolbox
│ └──────┬──────┘ │
│        ▼        │
│ ┌─────────────┐ │
│ │ 4c. 검증    │ │ ──▶ 무결성, 속성 비교
│ └──────┬──────┘ │
│        ▼        │
│ ┌─────────────┐ │
│ │ 4d. 메타    │ │ ──▶ ExifTool 메타데이터 복원
│ │    데이터   │ │
│ └──────┬──────┘ │
│        ▼        │
│ ┌─────────────┐ │
│ │ 4e. 정리    │ │ ──▶ 원본 → processed 폴더
│ └─────────────┘ │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 5. 보고서 생성   │ ──▶ 성공/실패/절약 공간
│                 │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 6. 알림 발송    │ ──▶ macOS 알림 센터
│                 │
└────────┬────────┘
         │
         ▼
[종료]
```

### 8.3 수동 변환 플로우 (CLI)

```
[사용자 명령어 입력]
   │
   ▼
$ video-converter convert input.mp4 output.mp4 --mode hardware --quality 45
   │
   ▼
┌─────────────────┐
│ 1. 입력 검증    │ ──▶ 파일 존재, 코덱 확인
│                 │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 2. 변환 실행    │ ──▶ 진행률 바 표시
│                 │     [████████░░░░░░░░] 50% (2:30 remaining)
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 3. 후처리       │ ──▶ 메타데이터, 타임스탬프
│                 │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 4. 결과 출력    │ ──▶ ✅ 완료: 1.5GB → 680MB (54% 절약)
│                 │
└─────────────────┘
```

---

## 9. UI/UX 요구사항

### 9.1 CLI 인터페이스

#### 명령어 구조

```bash
video-converter <command> [options]

Commands:
  convert     단일 파일 변환
  run         배치 변환 실행
  status      서비스 상태 확인
  stats       변환 통계 조회
  config      설정 관리
  install     서비스 설치
  uninstall   서비스 제거

Global Options:
  --config    설정 파일 경로
  --verbose   상세 로그 출력
  --quiet     최소 출력
  --help      도움말 표시
```

#### 출력 포맷

**진행률 표시**:
```
Converting: vacation_2024.mp4
[████████████░░░░░░░░] 60% | 1.2GB → 540MB | ETA: 1:45
```

**완료 요약**:
```
╭─────────────────────────────────────────────╮
│           변환 완료 보고서                   │
├─────────────────────────────────────────────┤
│  처리 영상:     15개                         │
│  성공:          14개                         │
│  실패:          1개                          │
│  건너뜀:        3개 (이미 HEVC)              │
├─────────────────────────────────────────────┤
│  원본 크기:     35.2 GB                      │
│  변환 크기:     15.8 GB                      │
│  절약 공간:     19.4 GB (55%)                │
├─────────────────────────────────────────────┤
│  총 소요 시간:  45분 32초                    │
│  평균 속도:     3.2x 실시간                  │
╰─────────────────────────────────────────────╯
```

**에러 표시**:
```
❌ Error: vacation_corrupted.mp4
   원인: Invalid data found when processing input
   해결: 파일이 손상되었습니다. 원본 확인 필요
   위치: ~/Videos/Failed/vacation_corrupted.mp4
```

### 9.2 macOS 알림

**성공 알림**:
```
┌─────────────────────────────────┐
│ 🎬 Video Converter              │
│                                 │
│ 변환 완료                        │
│ 14개 영상, 19.4GB 절약          │
│                                 │
│ [상세 보기]    [닫기]           │
└─────────────────────────────────┘
```

**에러 알림**:
```
┌─────────────────────────────────┐
│ ⚠️ Video Converter              │
│                                 │
│ 변환 실패                        │
│ 1개 영상 변환 중 오류 발생       │
│                                 │
│ [로그 확인]    [닫기]           │
└─────────────────────────────────┘
```

### 9.3 설정 파일 포맷

```json
{
  "version": "1.0.0",
  "encoding": {
    "mode": "hardware",
    "quality": 45,
    "crf": 22,
    "preset": "slow"
  },
  "paths": {
    "output": "~/Videos/Converted",
    "processed": "~/Videos/Processed",
    "failed": "~/Videos/Failed"
  },
  "automation": {
    "enabled": true,
    "schedule": "daily",
    "time": "03:00"
  },
  "photos": {
    "include_albums": [],
    "exclude_albums": ["Screenshots"],
    "download_from_icloud": true
  },
  "processing": {
    "max_concurrent": 2,
    "validate_quality": true,
    "preserve_original": true
  },
  "notification": {
    "on_complete": true,
    "on_error": true,
    "daily_summary": false
  }
}
```

---

## 10. 범위 정의

### 10.1 In Scope (포함)

#### v1.0 범위

| 카테고리 | 포함 항목 |
|---------|----------|
| **플랫폼** | macOS 12.0+ (Apple Silicon) |
| **소스** | Apple Photos 라이브러리, 로컬 폴더 |
| **코덱** | H.264 → H.265 변환 |
| **인코더** | VideoToolbox (HW), libx265 (SW) |
| **자동화** | launchd 스케줄/폴더 감시 |
| **인터페이스** | CLI |
| **메타데이터** | GPS, 날짜, 카메라 정보 |
| **알림** | macOS Notification Center |

### 10.2 Out of Scope (제외)

#### v1.0에서 제외

| 항목 | 사유 | 향후 계획 |
|------|------|----------|
| GUI 앱 | 개발 복잡도 | v2.0 검토 |
| Photos 앱 내 교체 | API 제한 | 기술 조사 필요 |
| Windows/Linux | 플랫폼 특화 | 미정 |
| iOS/iPadOS | 플랫폼 특화 | v3.0 검토 |
| AV1 코덱 | M3+ 전용 | v1.x 검토 |
| 실시간 스트리밍 | 용도 상이 | 제외 |
| 비디오 편집 | 용도 상이 | 제외 |
| 클라우드 저장소 | 복잡도 | v2.0 검토 |

### 10.3 가정 및 의존성

**가정**:
- 사용자가 macOS Photos 앱을 기본 비디오 관리 도구로 사용
- Apple Silicon Mac 보유 (하드웨어 가속 필수)
- Homebrew 설치 가능 환경
- 기본적인 터미널 사용 능력

**의존성**:
- FFmpeg: 비디오 변환 핵심 엔진
- osxphotos: Photos 라이브러리 접근
- ExifTool: 메타데이터 처리
- launchd: macOS 자동화 인프라

---

## 11. 의존성 및 제약사항

### 11.1 기술적 제약사항

| 제약 | 영향 | 대응 방안 |
|------|------|----------|
| Photos 라이브러리 직접 수정 불가 | 변환된 파일 별도 저장 | 출력 폴더 명확히 안내 |
| VideoToolbox 품질 제한 | SW 대비 약간 큰 파일 | 품질 프리셋 제공 |
| iCloud 동기화 지연 | 일부 영상 처리 불가 | 재시도 로직, 대기 옵션 |
| 대용량 파일 메모리 | 일부 시스템 부담 | 스트리밍 처리 |

### 11.2 운영 제약사항

| 제약 | 영향 | 대응 방안 |
|------|------|----------|
| 전원 연결 필요 (노트북) | 배터리 소모 | 전원 상태 확인 |
| 저장 공간 2배 필요 | 변환 중 공간 부족 가능 | 사전 공간 확인 |
| 야간 실행 시 Mac 켜져있어야 함 | 스케줄 누락 가능 | 다음 실행 시 처리 |

---

## 12. 성공 지표

### 12.1 핵심 성과 지표 (KPIs)

| 지표 | 목표 | 측정 주기 | 데이터 소스 |
|------|------|----------|------------|
| **변환 성공률** | 99%+ | 배치별 | 실행 로그 |
| **평균 압축률** | 50%+ | 배치별 | 변환 결과 |
| **메타데이터 보존율** | 100% | 파일별 | 자동 검증 |
| **VMAF 품질 점수** | 93+ | 샘플링 | VMAF 측정 |
| **사용자 설정 시간** | 5분 이내 | 온보딩 | 사용자 피드백 |

### 12.2 비즈니스 지표

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| 사용자당 절약 공간 | 50GB+/월 | 통계 집계 |
| 일간 활성 사용률 | 80%+ | 서비스 로그 |
| 에러 발생률 | 1% 미만 | 에러 로그 |
| 사용자 만족도 (NPS) | 50+ | 설문 조사 |

### 12.3 품질 지표

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| 버그 발생률 | Critical 0, Major 월 2건 이하 | 이슈 트래킹 |
| 테스트 커버리지 | 80%+ | pytest-cov |
| 코드 품질 점수 | A 등급 | CodeClimate |

---

## 13. 릴리스 계획

### 13.1 릴리스 로드맵

```
2025 Q1
├── v0.1.0 (Alpha) - Week 2
│   └── 기본 변환 기능, CLI 최소 구현
│
├── v0.5.0 (Beta) - Week 5
│   └── Photos 통합, 메타데이터 보존
│
└── v1.0.0 (Release) - Week 8
    └── 자동화, 완전한 CLI, 문서화

2025 Q2
├── v1.1.0
│   └── GUI 앱 (기본), 앨범 필터
│
└── v1.2.0
    └── VMAF 검증, 체크포인트

2025 Q3+
└── v2.0.0
    └── AV1 지원, Photos 교체 기능 연구
```

### 13.2 버전별 기능 매핑

| 버전 | 주요 기능 | 대상 사용자 |
|------|----------|------------|
| **v0.1.0** | 단일 파일 변환, HW/SW 인코더 | 개발/테스트 |
| **v0.5.0** | Photos 스캔, 배치 변환, 메타데이터 | 얼리어답터 |
| **v1.0.0** | launchd 자동화, 알림, 완전한 CLI | 일반 사용자 |
| **v1.1.0** | 기본 GUI, 앨범 필터, VMAF | 일반 사용자 |
| **v2.0.0** | Photos 교체, AV1 | 모든 사용자 |

### 13.3 릴리스 체크리스트

**Pre-Release**:
- [ ] 모든 P0 기능 구현 완료
- [ ] 단위 테스트 80%+ 커버리지
- [ ] 통합 테스트 통과
- [ ] 성능 벤치마크 목표 달성
- [ ] 보안 검토 완료

**Release**:
- [ ] CHANGELOG 업데이트
- [ ] 버전 태그 생성
- [ ] PyPI 배포
- [ ] GitHub Release 생성
- [ ] 문서 업데이트

**Post-Release**:
- [ ] 사용자 피드백 수집
- [ ] 버그 모니터링
- [ ] 성능 메트릭 확인

---

## 14. 부록

### 14.1 용어 정의

| 용어 | 정의 |
|------|------|
| H.264 | AVC (Advanced Video Coding), 2003년 표준화된 비디오 코덱 |
| H.265 | HEVC (High Efficiency Video Coding), 2013년 표준화, H.264 대비 50% 효율 향상 |
| VideoToolbox | Apple의 하드웨어 비디오 인코딩/디코딩 프레임워크 |
| CRF | Constant Rate Factor, 품질 기반 인코딩 설정 (낮을수록 고품질) |
| VMAF | Video Multimethod Assessment Fusion, Netflix 개발 품질 지표 (0-100) |
| launchd | macOS의 서비스 관리 프레임워크 |
| osxphotos | Python 기반 Photos 라이브러리 접근 도구 |

### 14.2 참조 문서

**설계 문서**:
- [소프트웨어 요구사항 명세서 (SRS)](SRS.ko.md)
- **[소프트웨어 설계 명세서 (SDS)](SDS.ko.md)** - 본 PRD의 기술적 설계 구현
- [개발 계획서](development-plan.ko.md)

**아키텍처 문서**:
- [시스템 아키텍처](architecture/01-system-architecture.ko.md)
- [시퀀스 다이어그램](architecture/02-sequence-diagrams.ko.md)
- [데이터 흐름](architecture/03-data-flow-and-states.ko.md)
- [처리 절차](architecture/04-processing-procedures.ko.md)

**참조 자료**:
- [코덱 비교](reference/01-codec-comparison.ko.md)
- [FFmpeg 가이드](reference/02-ffmpeg-hevc-encoding.ko.md)
- [VideoToolbox 가이드](reference/03-videotoolbox-hardware-acceleration.ko.md)
- [Photos 접근 방법](reference/04-macos-photos-access.ko.md)
- [자동화 방법](reference/05-macos-automation-methods.ko.md)

### 14.3 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0.0 | 2025-12-21 | - | 최초 작성 |

---

## 승인

| 역할 | 이름 | 서명 | 날짜 |
|------|------|------|------|
| Product Owner | | | |
| Tech Lead | | | |
| Design Lead | | | |

---

*이 문서는 프로젝트 진행에 따라 업데이트됩니다.*
